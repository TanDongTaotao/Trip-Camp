# 目录结构与分工说明（Trip-Camp）

本仓库采用“三端分离”结构：

- 用户端（移动端/小程序）：Taro（React 语法）
  - 技术栈：Taro 4 + React 18 + Webpack5 runner
- 管理端（PC 后台）：React + Ant Design
  - 技术栈：React + Ant Design + 路由（按成员 C 项目初始化为准）
- 服务端（后端）：Express + MongoDB
  - 技术栈：Node.js + Express + MongoDB Atlas（Mongoose）+ JWT + bcryptjs + nodemon

## 仓库总览

```text
Trip-Camp/
  apps/
    mobile/                 # 用户端（Taro 项目，由成员 B 维护）
    admin/                  # 管理端（React+AntD 项目，由成员 C 维护）
  server/                   # 服务端（Express 项目，由成员 A 维护）
    src/
      routes/               # 路由定义（按模块拆分：auth/hotels/merchant/admin）
      controllers/          # 控制器：处理请求参数与响应组装
      middlewares/          # 中间件：鉴权、角色校验、错误处理等
      models/               # 数据模型：MongoDB/Mongoose schema
      utils/                # 工具：配置读取、JWT、密码加密、错误码等
  apifox-openapi.yaml        # 接口文档（OpenAPI，可导入 Apifox）
  接口注释说明文档.txt        # 接口说明（状态机、错误码、落地顺序）
  阶段1验收清单.md            # 阶段 1 验收清单（启动/注册/登录/me/三端验收点）
  .gitignore
```

## 成员 A（后端/数据架构）：代码放哪里、做什么

你负责 `server/` 目录，所有后端相关代码都放这里。

建议工作分布（落地时按你们实际文件命名即可）：

- 路由：`server/src/routes/`
  - `auth.*`：注册/登录/me
  - `hotels.*`：用户端酒店列表/详情
  - `merchant.*`：商户酒店管理（新建/编辑/提交审核）
  - `admin.*`：管理员审核/发布/下线
- 控制器：`server/src/controllers/`
  - 每个模块一个控制器文件（auth/hotels/merchant/admin），负责参数读取、调用 service/model、返回 JSON
- 中间件：`server/src/middlewares/`
  - `requireAuth`：解析 Bearer token，把用户挂到 req 上
  - `requireRole`：校验角色（merchant/admin）
  - `errorHandler`：统一错误返回 `{code,message,details?}`
- 模型：`server/src/models/`
  - `User`、`Hotel`（可选后续加 `Order`）
- 工具：`server/src/utils/`
  - JWT 签发/校验、bcrypt 密码加密、环境变量读取、错误码常量等

你交付的对外接口契约以 `apifox-openapi.yaml` 为准，前端会严格按这个对接。

## 成员 B（用户端/Taro）：代码放哪里、做什么

你负责 `apps/mobile/` 目录，在该目录初始化并维护 Taro 项目。

建议的模块划分（你们按习惯建目录即可）：

- 页面（首页/列表/详情）：放在 Taro 项目的 `src/pages/`（或你们项目默认目录）
- 通用组件：放在 `src/components/`
- 请求封装：放在 `src/services/` 或 `src/api/`
  - Base URL 统一使用 `http://localhost:3000/api/v1`（开发期）

你主要对接这些接口：

- `GET /hotels`
- `GET /hotels/:id`
- （后续若扩展订单）对应订单接口

## 成员 C（管理端/React+AntD）：代码放哪里、做什么

你负责 `apps/admin/` 目录，在该目录初始化并维护管理端项目。

建议的模块划分：

- 页面：`src/pages/`（登录、酒店录入/编辑、审核列表等）
- 布局与路由：`src/layout/`、`src/router/`（或你们习惯的目录）
- 通用组件：`src/components/`
- 请求封装：`src/services/` 或 `src/api/`
  - Base URL 统一使用 `http://localhost:3000/api/v1`（开发期）
  - 登录后保存 token，并在请求头统一携带

你主要对接这些接口：

- `POST /auth/login`、`GET /auth/me`
- 商户：`/merchant/hotels*`
- 管理员：`/admin/hotels*`

## 协作约定（避免联调混乱）

- 接口变更：先改 `apifox-openapi.yaml`，再改后端实现，最后通知前端同步
- 主分支可运行：`main` 分支必须随时能启动（至少一个端不崩）
- 环境变量不提交：`.env` 不进仓库，统一用 `.env.example`（需要时再补）
